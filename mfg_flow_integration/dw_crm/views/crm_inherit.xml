<odoo>
    <data>
        <!-- Form View Inheritance -->
        <record id="crm_lead_form_dreamwarez" model="ir.ui.view">
            <field name="name">crm.lead.form.dreamwarez</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_lead_view_form"/>
            <field name="arch" type="xml">

                <xpath expr="//span[@class='oe_grey p-2' and contains(text(),'at')]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='tag_ids']" position="after">
                    <field name="engineering_team_id"/>
                </xpath>
            
                <xpath expr="//field[@name='stage_id']" position="attributes">
                    <attribute name="readonly">1</attribute>
                </xpath>
                <xpath expr="//notebook" position="inside">
                    <page string="Department Time Tracking">
                        <field name="department_times_ids" readonly="1">
                            <tree>
                                <field name="stage_name"/>
                                <field name="user_id"/>
                                <field name="start_time"/>
                                <field name="end_time"/>
                                <field name="total_duration"/>
                                <field name="status"/>
                            </tree>
                        </field>
                    </page>
                </xpath>

                <!-- Hide entire Expected Revenue + Probability block -->
                <xpath expr="//div[@id='probability']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                
                <xpath expr="//field[@name='expected_revenue']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <!-- Hide Expected Closing Date and Tags -->
                <xpath expr="//field[@name='date_deadline']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='tag_ids']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <!-- Add Products Tab -->
                <xpath expr="//notebook/page[1]" position="before">
                    <page string="Products">
                        <field name="product_line_ids">
                            <tree editable="bottom">
                                <field name="product_id"/>
                                <field name="quantity"/>
                                <field name="unit_price"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
                
                <xpath expr="//header/button[@name='action_sale_quotations_new']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//header/button[@name='action_sale_quotations_new']" position="attributes">
                    <attribute name="groups">dw_crm.group_crm_sales_team</attribute>
                    <attribute name="invisible">stage_id.id != %(dw_crm.stage_analysis_done)d</attribute>
                </xpath>

                <xpath expr="//header/button[contains(@name,'action_set_won')]" position="attributes">
                    <attribute name="invisible">stage_id.id != %(dw_crm.stage_quotation_sent)d </attribute>
                </xpath>

                <!-- <xpath expr="//header/button[@name='334']" position="attributes">
                    <attribute name="invisible">stage_id.id != %(dw_crm.stage_quotation_sent)d </attribute>
                </xpath> -->

                <xpath expr="//header" position="inside">
                    <button name="action_send_to_engineering"
                            type="object"
                            string="Send For Analysis"
                            class="oe_highlight"
                            groups="dw_crm.group_crm_sales_team"
                            invisible="stage_id != %(dw_crm.stage_new)d"/>
                </xpath>
            
                <xpath expr="//header" position="inside">
                    <button name="action_sale_quotations_new"
                            type="object"
                            string="New Quotation"
                            class="oe_highlight"
                            groups="dw_crm.group_crm_sales_team"
                            invisible="stage_id != %(dw_crm.stage_analysis_done)d"/>
                </xpath>
                <xpath expr="//header" position="inside">
                    <button name="action_set_won_rainbowman"
                            type="object"
                            string="Won"
                            class="oe_highlight"
                            groups="dw_crm.group_crm_sales_team"
                            invisible="stage_id != %(dw_crm.stage_quotation_sent)d"/>
                </xpath>
                <xpath expr="//header" position="inside">
                    <button name="334"
                            string="Lost"
                            type="action"
                            class="oe_highlight"
                            groups="dw_crm.group_crm_sales_team"
                            invisible="stage_id != %(dw_crm.stage_quotation_sent)d"/>
                </xpath>
            </field>
        </record>

        <!-- Tree/List View Inheritance -->
        <record id="crm_lead_tree_dreamwarez" model="ir.ui.view">
            <field name="name">crm.lead.tree.dreamwarez</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_tree_view_leads"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="after">
                    <field name="engineering_team_id"/>
                </xpath>
            </field>
        </record>

        <record id="crm.crm_menu_root" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [ref('dw_crm.group_crm_sales_team')])]"/>
        </record>

        <record id="crm.crm_menu_leads" model="ir.ui.menu">
            <field name="groups_id" eval="[(6, 0, [ref('dw_crm.group_crm_sales_team')])]"/>
        </record>

    </data>
</odoo>
